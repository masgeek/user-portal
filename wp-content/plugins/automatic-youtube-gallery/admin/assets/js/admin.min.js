!function(e){"use strict";function t(e){var t=e;return void 0!==(e=e.replace(/(>|<)/gi,"").split(/(vi\/|v=|\/v\/|youtu\.be\/|\/embed\/)/))[2]&&(t=(t=e[2].split(/[^0-9a-z_\-]/i))[0]),t}function a(t){t.find(".ayg-color-picker").wpColorPicker({change:_.throttle(function(){e(this).trigger("change")},3e3)})}function i(e,t){a(t)}e(function(){e(".ayg-color-picker").wpColorPicker(),e.fn.magnificPopup&&e(".ayg-modal-button").magnificPopup({type:"inline",mainClass:"mfp-fade"}),e("#ayg-button-save-api-key").on("click",function(t){t.preventDefault(),e(this).prop("disabled",!0),e(".ayg-ajax-status","#ayg-table-api-key").html('<span class="spinner"></span>');var a={action:"ayg_save_api_key",api_key:e("#ayg-api-key").val(),security:ayg_admin.ajax_nonce};if(!a.api_key)return e(this).prop("disabled",!1),e(".ayg-ajax-status","#ayg-table-api-key").html('<span class="ayg-text-error">'+ayg_admin.i18n.invalid_api_key+"</span>"),!1;e.post(ajaxurl,a,function(e){window.location.reload()})}),e("#ayg-generate-shortcode").on("click",function(a){a.preventDefault();var i={};e(".ayg-editor-control","#ayg-shortcode-builder").each(function(){var a=e(this).find(".ayg-editor-field"),n=a.attr("type"),o=a.attr("name"),s=a.val(),r=a.data("default");if("checkbox"==n&&(s=a.is(":checked")?1:0),"playlist"==o&&(s=(l=s,(c=/[&|\?]list=([a-zA-Z0-9_-]+)/gi.exec(l))&&c.length>0?c[1]:l)),"channel"==o){var l,c,g,d,p,y=(g=s,d="channel",p=g,void 0!==(g=g.replace(/(>|<)/gi,"").split(/(\/channel\/|\/user\/)/))[2]&&(p=(p=g[2].split(/[^0-9a-z_-]/i))[0]),/\/user\//.test(g)&&(d="username"),{type:d,id:p});o=y.type,s=y.id,i.hasOwnProperty("type")&&"channel"==i.type&&(i.type=o)}if("video"==o&&(s=t(s)),"videos"==o){var u=s.split("\n"),h=[];u.map(function(e){h.push(t(e))}),s=h.join(",")}s!=r&&(i[o]=s)});var n="";for(var o in i)i.hasOwnProperty(o)&&(n+=" "+o+'="'+i[o]+'"');e("#aiovg-shortcode").val("[automatic_youtube_gallery"+n+"]")}),e(document).on("click",".ayg-editor-section-header",function(t){var a=e(this).parent();a.hasClass("ayg-active")||e(this).closest(".ayg-editor").find(".ayg-editor-section.ayg-active").toggleClass("ayg-active").find(".ayg-editor-controls").slideToggle(),a.toggleClass("ayg-active").find(".ayg-editor-controls").slideToggle()}),e(document).on("change",".ayg-editor-field-type",function(){var t=e(this).closest(".ayg-editor"),a=e(this).val();t.removeClass(function(e,t){var a=t.match(/\ayg-editor-field-type-\S+/ig);return a?a.join(" "):""}),t.addClass("ayg-editor-field-type-"+a)}),e(document).on("change",".ayg-editor-field-theme",function(){var t=e(this).closest(".ayg-editor"),a=e(this).val();t.removeClass(function(e,t){var a=t.match(/\ayg-editor-field-theme-\S+/ig);return a?a.join(" "):""}),t.addClass("ayg-editor-field-theme-"+a)}),e(document).on("change",".ayg-editor-field-pagination_type",function(){var t=e(this).closest(".ayg-editor"),a=e(this).val();t.removeClass(function(e,t){var a=t.match(/\ayg-editor-field-pagination_type-\S+/ig);return a?a.join(" "):""}),t.addClass("ayg-editor-field-pagination_type-"+a)}),e("tr.theme select","#ayg-settings").on("change",function(){var t=e("#ayg-settings"),a=e(this).val();t.removeClass(function(e,t){var a=t.match(/theme-\S+/ig);return a?a.join(" "):""}),t.addClass("theme-"+a)}),e("tr.pagination_type select","#ayg-settings").on("change",function(){var t=e("#ayg-settings"),a=e(this).val();t.removeClass(function(e,t){var a=t.match(/pagination_type-\S+/ig);return a?a.join(" "):""}),t.addClass("pagination_type-"+a)}),e('tr.player_type input[type="radio"]',"#ayg-settings").on("change",function(){var t=e("#ayg-settings"),a=t.find('tr.player_type input[type="radio"]:checked').val();t.removeClass(function(e,t){var a=t.match(/player_type-\S+/ig);return a?a.join(" "):""}),t.addClass("player_type-"+a)}),e(".ayg-settings-browse").on("click",function(t){t.preventDefault(),function t(a){var i,n;if(i){i.open();return}(i=wp.media.frames.file_frame=wp.media({frame:"post",state:"insert",multiple:!1})).on("insert",function(){n=i.state().get("selection").first().toJSON(),!(0>e.trim(n.url.length))&&a.prev(".ayg-settings-url").val(n.url)}),i.open()}(e(this))}),e("#ayg-button-delete-cache").on("click",function(t){t.preventDefault(),e(this).prop("disabled",!0),e(".ayg-ajax-status","#ayg-table-delete-cache").html('<span class="spinner"></span>');var a={action:"ayg_delete_cache",security:ayg_admin.ajax_nonce};e.post(ajaxurl,a,function(t){e(this).prop("disabled",!1),e(".ayg-ajax-status","#ayg-table-delete-cache").html('<span class="ayg-text-success">'+ayg_admin.i18n.cleared+"</span>")})}),e("#widgets-right .widget:has(.ayg-color-picker)").each(function(){a(e(this))}),e(document).on("widget-added widget-updated",i)})}(jQuery);